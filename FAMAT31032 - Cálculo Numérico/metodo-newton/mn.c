//===================================================================================================
/*
UNIVERSIDADE FEDERAL DE UBERLÂNDIA
INSTITUTO DE MATEMÁTICA E DE ESTATÍSTICA
DISCIPLINA: CÁLCULO NUMÉRICO (FAMAT31032)
CURSO: CIÊNCIA DA COMPUTAÇÃO
CÓDIGO: MÉTODO DE NEWTON
*/
//===================================================================================================
/* PRÉ PROCESSADORES */
//===================================================================================================
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
//===================================================================================================
/* SUB-ROTINAS */
//===================================================================================================
// FUNÇÃO f(x)
double f (double x) {
    return (x - cos(x));
}
// DERIVADA DA FUNÇÃO f(x) = f'(x)
double df (double x) {
    return (1.0 + sin(x));
}
//===================================================================================================
/* PROGRAMA PRINCIPAL */
//===================================================================================================
int main(int argc, char *argv[]) {
    //===============================================================================================
    /* DECLARAÇÃO DE VARIÁVEIS */
    //===============================================================================================
    int k; // contador do número de iterações
    double xold, xnew; // xk e xk+1 do método de newton (variáveis auxiliares)
    double er; // erro relativo
    double eps; // precisão (acurácia)
    //===============================================================================================
    /* LIMPEZA DO TERMINAL */
    //===============================================================================================
    system("cls");
    //===============================================================================================
    /* ENTRADA DE DADOS */
    //===============================================================================================
    xold = atof(argv[1]); 
    eps = atof(argv[2]);
    //===============================================================================================
    /* APLICAÇÃO DO MÉTODO DE NEWTON */
    //===============================================================================================
    k = 0;
    er = 1;
    while(er > eps) { 
        k++;
        xnew = xold-f(xold)/ df(xold);
        er = fabs(xnew-xold)/fabs(xnew);
        xold = xnew;
    }
    //===============================================================================================
    /* IMPRESSÃO DOS RESULTADOS */
    //===============================================================================================
    printf("\nAproximacao de x: %.15lf", xnew);
    printf("\nf(x): %e", f(xnew));
    printf("\nNumero de iteracoes: %d", k);
    printf("\nErro relativo: %e", er);
    //===============================================================================================
    /* FIM DO PROGRAMA */
    //===============================================================================================
    return 0;
}
// gcc -o mn mn.c -lm
// ./mn 0.5 1e-12